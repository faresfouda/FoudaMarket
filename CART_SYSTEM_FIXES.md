# ุฅุตูุงุญุงุช ูุธุงู ุงูุณูุฉ (Cart System Fixes)

## ุงููุดุงูู ุงูุชู ุชู ุญููุง

### 1. ุฅุถุงูุฉ CartBloc ุฅูู main.dart
- ุชู ุฅุถุงูุฉ `CartBloc` ุฅูู `MultiBlocProvider` ูู `main.dart`
- ุชู ุฅุถุงูุฉ ุงูู import ุงููุทููุจ: `import 'blocs/cart/cart_bloc.dart';`

### 2. ุฅุตูุงุญ main_screen.dart
- ุชู ุฅุฒุงูุฉ `MultiBlocProvider` ุงูููุฑุฑ ูู `main_screen.dart`
- ุชู ุฅุถุงูุฉ ุชุญููู ุงูุณูุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู
- ุชู ุฅุถุงูุฉ ุงูู imports ุงููุทููุจุฉ

### 3. ุฅุถุงูุฉ ุนุฏุงุฏ ุงูุนูุงุตุฑ ูู ุดุฑูุท ุงูุชููู
- ุชู ุชุญุฏูุซ `my_navigationbar.dart` ูุนุฑุถ ุนุฏุฏ ุงูุนูุงุตุฑ ูู ุงูุณูุฉ
- ุชู ุฅุถุงูุฉ `BlocBuilder` ููุฑุงูุจุฉ ุญุงูุฉ ุงูุณูุฉ
- ุชู ุฅุถุงูุฉ badge ุฃุญูุฑ ูุนุฑุถ ุนุฏุฏ ุงูุนูุงุตุฑ

### 4. ุฅุฒุงูุฉ ุงูู imports ุบูุฑ ุงููุณุชุฎุฏูุฉ
- ุชู ุฅุฒุงูุฉ `import '../../models/cart_item_model.dart'` ูู `cart_bloc.dart`
- ุชู ุฅุฒุงูุฉ imports ุบูุฑ ูุณุชุฎุฏูุฉ ูู `cart_screen.dart`
- ุชู ุฅุฒุงูุฉ imports ุบูุฑ ูุณุชุฎุฏูุฉ ูู `main_screen.dart`

## ุงููููุงุช ุงููุญุฏุซุฉ

### 1. lib/main.dart
```dart
// ุฅุถุงูุฉ CartBloc ุฅูู MultiBlocProvider
BlocProvider<CartBloc>(
  create: (context) => CartBloc(),
),
```

### 2. lib/views/home/main_screen.dart
```dart
// ุฅุถุงูุฉ ุชุญููู ุงูุณูุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู
@override
void initState() {
  super.initState();
  WidgetsBinding.instance.addPostFrameCallback((_) {
    _loadCart();
  });
}

void _loadCart() {
  final user = FirebaseAuth.instance.currentUser;
  if (user != null) {
    context.read<CartBloc>().add(LoadCart(user.uid));
  }
}
```

### 3. lib/views/home/widgets/my_navigationbar.dart
```dart
// ุฅุถุงูุฉ ุนุฏุงุฏ ุงูุนูุงุตุฑ ูู ุงูุณูุฉ
icon: BlocBuilder<CartBloc, CartState>(
  builder: (context, state) {
    int cartCount = 0;
    if (state is CartLoaded) {
      cartCount = state.itemsCount;
    }
    return Stack(
      children: [
        SvgPicture.asset(...),
        if (cartCount > 0)
          Positioned(
            right: 0,
            top: 0,
            child: Container(
              // Badge design
            ),
          ),
      ],
    );
  },
),
```

## ุงูููุฒุงุช ุงููุถุงูุฉ

### 1. ุนุฏุงุฏ ุงูุนูุงุตุฑ ูู ุดุฑูุท ุงูุชููู
- ูุนุฑุถ ุนุฏุฏ ุงูุนูุงุตุฑ ูู ุงูุณูุฉ ุนูู ุฃููููุฉ ุงูุณูุฉ
- ูุฎุชูู ุนูุฏูุง ุชููู ุงูุณูุฉ ูุงุฑุบุฉ
- ูุชู ุชุญุฏูุซู ุชููุงุฆูุงู ุนูุฏ ุฅุถุงูุฉ ุฃู ุฅุฒุงูุฉ ุนูุงุตุฑ

### 2. ุชุญููู ุชููุงุฆู ููุณูุฉ
- ูุชู ุชุญููู ุงูุณูุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู
- ูุนูู ูุน ูุธุงู ุงููุตุงุฏูุฉ ุงูุญุงูู

### 3. ุฅุฏุงุฑุฉ ุฃูุถู ููู Bloc
- ุงุณุชุฎุฏุงู bloc ูุงุญุฏ ูุดุชุฑู ูู ุฌููุน ุฃูุญุงุก ุงูุชุทุจูู
- ุชุฌูุจ ุฅูุดุงุก blocs ูุชุนุฏุฏุฉ

## ุงุฎุชุจุงุฑ ุงููุธุงู

### 1. ุฅุถุงูุฉ ููุชุฌ ุฅูู ุงูุณูุฉ
1. ุงูุชูู ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
2. ุงุถุบุท ุนูู ุฒุฑ "+" ูู ุฃู ููุชุฌ
3. ุชุฃูุฏ ูู ุธููุฑ ุฑุณุงูุฉ ูุฌุงุญ
4. ุชุญูู ูู ุชุญุฏูุซ ุงูุนุฏุงุฏ ูู ุดุฑูุท ุงูุชููู

### 2. ุนุฑุถ ุงูุณูุฉ
1. ุงุถุบุท ุนูู ุฃููููุฉ ุงูุณูุฉ ูู ุดุฑูุท ุงูุชููู
2. ุชุฃูุฏ ูู ุนุฑุถ ุงูููุชุฌุงุช ุงููุถุงูุฉ
3. ุงุฎุชุจุฑ ุชุบููุฑ ุงููููุงุช
4. ุงุฎุชุจุฑ ุฅุฒุงูุฉ ุงูููุชุฌุงุช

### 3. ุชูุฑูุบ ุงูุณูุฉ
1. ุฃุถู ุนุฏุฉ ููุชุฌุงุช ุฅูู ุงูุณูุฉ
2. ุงูุชูู ุฅูู ุตูุญุฉ ุงูุณูุฉ
3. ุงุถุบุท ุนูู ุฃููููุฉ ุชูุฑูุบ ุงูุณูุฉ
4. ุชุฃูุฏ ูู ุชูุฑูุบ ุงูุณูุฉ ุจุงููุงูู

## ุฑุณุงุฆู ุงูุชุตุญูุญ ุงููุถุงูุฉ

### ูู CartService
- `๐ [DEBUG] Getting cart items for user: $userId`
- `โ [DEBUG] Found ${items.length} cart items for user: $userId`
- `๐ [DEBUG] Adding to cart: ${cartItem.productName}`
- `๐ [DEBUG] Updating existing cart item`
- `โ [DEBUG] Adding new cart item to collection: carts`

### ูู CartBloc
- `๐ [CART_BLOC] Loading cart for user: ${event.userId}`
- `๐ [CART_BLOC] Cart loaded - Items: ${cartItems.length}, Total: $total`
- `โ [CART_BLOC] Adding to cart: ${event.cartItem.productName}`
- `โ [CART_BLOC] Product added to cart successfully`

## ููุงุญุธุงุช ูููุฉ

1. **ูุฌููุนุฉ Firestore**: ูุชู ุงุณุชุฎุฏุงู ูุฌููุนุฉ `carts` ุจุฏูุงู ูู `cart_items`
2. **ูุนุฑู ุงููุณุชุฎุฏู**: ูุชู ุงุณุชุฎุฏุงู `user.uid` ูู Firebase Auth
3. **ุงูุชุญุฏูุซ ุงูุชููุงุฆู**: ูุชู ุชุญุฏูุซ ุงูุณูุฉ ุชููุงุฆูุงู ุจุนุฏ ูู ุนูููุฉ
4. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**: ุชู ุฅุถุงูุฉ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก ูุน ุฑุณุงุฆู ูุงุถุญุฉ

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. ุงุฎุชุจุงุฑ ุงููุธุงู ุนูู ุฌูุงุฒ ุญูููู
2. ุฅุถุงูุฉ ููุฒุงุช ุฅุถุงููุฉ ูุซู:
   - ุญูุธ ุงูุณูุฉ ูุญููุงู ููุนูู ุจุฏูู ุฅูุชุฑูุช
   - ุฅุถุงูุฉ ุฎุตููุงุช ุนูู ุงูุณูุฉ
   - ุฏุนู ุงูููุจููุงุช
3. ุชุญุณูู ุงูุฃุฏุงุก ุนูุฏ ูุฌูุฏ ุนูุงุตุฑ ูุซูุฑุฉ ูู ุงูุณูุฉ 