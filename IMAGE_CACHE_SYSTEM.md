# ูุธุงู ุงูุชุฎุฒูู ุงููุคูุช ููุตูุฑ - FoudaMarket

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅูุดุงุก ูุธุงู caching ุดุงูู ููุตูุฑ ูู ุชุทุจูู FoudaMarket ูุชุญุณูู ุงูุฃุฏุงุก ูุชูููู ุงุณุชููุงู ุงูุจูุงูุงุช ูุชูููุฑ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู.

## ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. **ุฅุฏุงุฑุฉ ุฐููุฉ ููุชุฎุฒูู**
- **ุญุฌู ุฃูุตู**: 100 ููุฌุงุจุงูุช ููุชุฎุฒูู ุงููุคูุช
- **ุนูุฑ ุฃูุตู**: 7 ุฃูุงู ูููููุงุช ุงููุฎุฒูุฉ
- **ุชูุธูู ุชููุงุฆู**: ุญุฐู ุงููููุงุช ุงููุฏููุฉ ุชููุงุฆูุงู
- **ุถุบุท ุฐูู**: ุญุฐู ุฃูุฏู ุงููููุงุช ุนูุฏ ุชุฌุงูุฒ ุงูุญุฏ ุงูุฃูุตู

### 2. **ุฃูุงู ูููุซูููุฉ**
- **ููุงุชูุญ ูุฑูุฏุฉ**: ุงุณุชุฎุฏุงู SHA-256 ูุชูููุฏ ููุงุชูุญ ูุฑูุฏุฉ ููุตูุฑ
- **ุชุญูู ูู ุงูุตุญุฉ**: ุงูุชุญูู ูู ุนูุฑ ุงููููุงุช ูุจู ุงูุงุณุชุฎุฏุงู
- **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**: ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก ูุน ุฑุณุงุฆู ูุงุถุญุฉ

### 3. **ูุงุฌูุฉ ุฅุฏุงุฑุฉ ูุชูุฏูุฉ**
- **ูุนูููุงุช ููุตูุฉ**: ุนุฑุถ ุญุฌู ุงูุชุฎุฒูู ูุนุฏุฏ ุงููููุงุช
- **ุดุฑูุท ุงูุชูุฏู**: ุนุฑุถ ูุณุจุฉ ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู
- **ุฃุฒุฑุงุฑ ุงูุชุญูู**: ูุณุญ ุงูุชุฎุฒูู ุงููุคูุช ูุชุญุฏูุซ ุงููุนูููุงุช

## ุงููููุงุช ุงููุญุฏุซุฉ

### 1. `lib/services/image_cache_service.dart`
ุฎุฏูุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฑุฆูุณูุฉ ูุน ุฌููุน ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ.

### 2. `lib/views/admin/widgets/cache_info_widget.dart`
Widget ูุนุฑุถ ูุนูููุงุช ุงูุชุฎุฒูู ุงููุคูุช ูุฅุฏุงุฑุชู.

### 3. `lib/views/admin/admin_profile_screen.dart`
ุฅุถุงูุฉ ุฎูุงุฑ "ูุนูููุงุช ุงูุชุฎุฒูู ุงููุคูุช" ูู ุงูููู ุงูุดุฎุตู ูููุฏูุฑ.

### 4. `pubspec.yaml`
ุฅุถุงูุฉ ุงูุชุจุนูุงุช ุงููุทููุจุฉ:
- `path_provider: ^2.1.2`
- `crypto: ^3.0.3`

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. **ุชููุฆุฉ ุงูุฎุฏูุฉ**
```dart
// ูู main.dart ุฃู ุนูุฏ ุจุฏุก ุงูุชุทุจูู
await ImageCacheService().initialize();
```

### 2. **ุญูุธ ุตูุฑุฉ ูู ุงูุชุฎุฒูู ุงููุคูุช**
```dart
final imageData = await http.get(Uri.parse(imageUrl));
if (imageData.statusCode == 200) {
  final cachePath = await ImageCacheService().cacheImage(
    imageUrl, 
    imageData.bodyBytes
  );
  if (cachePath != null) {
    print('ุชู ุญูุธ ุงูุตูุฑุฉ ูู: $cachePath');
  }
}
```

### 3. **ุงูุญุตูู ุนูู ุตูุฑุฉ ูู ุงูุชุฎุฒูู ุงููุคูุช**
```dart
final cachedFile = await ImageCacheService().getCachedImage(imageUrl);
if (cachedFile != null) {
  // ุงุณุชุฎุฏุงู ุงูุตูุฑุฉ ุงููุฎุฒูุฉ
  final image = FileImage(cachedFile);
} else {
  // ุชุญููู ุงูุตูุฑุฉ ูู ุงูุฅูุชุฑูุช
  // ...
}
```

### 4. **ุงูุชุญูู ูู ูุฌูุฏ ุตูุฑุฉ ูู ุงูุชุฎุฒูู ุงููุคูุช**
```dart
final isCached = await ImageCacheService().isImageCached(imageUrl);
if (isCached) {
  // ุงูุตูุฑุฉ ููุฌูุฏุฉ ูู ุงูุชุฎุฒูู ุงููุคูุช
} else {
  // ุชุญููู ุงูุตูุฑุฉ ูู ุงูุฅูุชุฑูุช
}
```

### 5. **ุงูุญุตูู ุนูู ูุนูููุงุช ุงูุชุฎุฒูู ุงููุคูุช**
```dart
final cacheInfo = await ImageCacheService().getCacheInfo();
print('ุงูุญุฌู ุงููุณุชุฎุฏู: ${cacheInfo.totalSizeMB} MB');
print('ุนุฏุฏ ุงููููุงุช: ${cacheInfo.fileCount}');
print('ูุณุจุฉ ุงูุงุณุชุฎุฏุงู: ${cacheInfo.usagePercentage}%');
```

### 6. **ูุณุญ ุงูุชุฎุฒูู ุงููุคูุช**
```dart
await ImageCacheService().clearCache();
```

## ูุงุฌูุฉ ุงูุฅุฏุงุฑุฉ

### **ุงููุตูู ุฅูู ูุนูููุงุช ุงูุชุฎุฒูู ุงููุคูุช**
1. ุงูุชูู ุฅูู **ุงูููู ุงูุดุฎุตู ูููุฏูุฑ**
2. ุงุถุบุท ุนูู **"ูุนูููุงุช ุงูุชุฎุฒูู ุงููุคูุช"**
3. ุณุชุธูุฑ ูุงูุฐุฉ ุชุญุชูู ุนูู:
   - ุงูุญุฌู ุงููุณุชุฎุฏู ูุงูุญุฏ ุงูุฃูุตู
   - ุดุฑูุท ุงูุชูุฏู ููุณุจุฉ ุงูุงุณุชุฎุฏุงู
   - ุนุฏุฏ ุงููููุงุช ูุงููููุงุช ุงูุตุงูุญุฉ
   - ุนูุฑ ุงูุชุฎุฒูู ุงูุฃูุตู
   - ุฒุฑ ูุณุญ ุงูุชุฎุฒูู ุงููุคูุช

### **ูุนูููุงุช ูุนุฑูุถุฉ**
- **ุงูุญุฌู ุงููุณุชุฎุฏู**: ุงููุณุงุญุฉ ุงููุณุชุฎุฏูุฉ ุจุงูููุฌุงุจุงูุช
- **ุงูุญุฏ ุงูุฃูุตู**: ุงูุญุฏ ุงูุฃูุตู ุงููุณููุญ (100 MB)
- **ูุณุจุฉ ุงูุงุณุชุฎุฏุงู**: ุดุฑูุท ูููู ููุถุญ ูุณุจุฉ ุงูุงุณุชุฎุฏุงู
- **ุนุฏุฏ ุงููููุงุช**: ุฅุฌูุงูู ุนุฏุฏ ุงููููุงุช ุงููุฎุฒูุฉ
- **ุงููููุงุช ุงูุตุงูุญุฉ**: ุนุฏุฏ ุงููููุงุช ุงูุชู ูู ุชูุชูู ุตูุงุญูุชูุง
- **ุนูุฑ ุงูุชุฎุฒูู ุงูุฃูุตู**: 7 ุฃูุงู

## ุฅุนุฏุงุฏุงุช ุงููุธุงู

### **ุงูุญุฏูุฏ ุงูุงูุชุฑุงุถูุฉ**
```dart
static const int _maxCacheSize = 100 * 1024 * 1024; // 100 MB
static const int _maxCacheAge = 7 * 24 * 60 * 60 * 1000; // 7 days
```

### **ุชุฎุตูุต ุงูุฅุนุฏุงุฏุงุช**
ูููู ุชุนุฏูู ูุฐู ุงูููู ูู `ImageCacheService` ุญุณุจ ุงุญุชูุงุฌุงุช ุงูุชุทุจูู:

```dart
// ุฒูุงุฏุฉ ุงูุญุฏ ุงูุฃูุตู ุฅูู 200 MB
static const int _maxCacheSize = 200 * 1024 * 1024;

// ุฒูุงุฏุฉ ุนูุฑ ุงูุชุฎุฒูู ุฅูู 14 ููู
static const int _maxCacheAge = 14 * 24 * 60 * 60 * 1000;
```

## ุขููุฉ ุงูุนูู

### 1. **ุชูููุฏ ุงูููุงุชูุญ**
```dart
String _generateCacheKey(String url) {
  final bytes = utf8.encode(url);
  final digest = sha256.convert(bytes);
  return digest.toString();
}
```

### 2. **ุญูุธ ุงููููุงุช**
- ุฅูุดุงุก ููุชุงุญ ูุฑูุฏ ููุตูุฑุฉ
- ุญูุธ ุงูุตูุฑุฉ ูู ูุฌูุฏ ุงูุชุฎุฒูู ุงููุคูุช
- ุชุญุฏูุซ timestamp ููููู
- ุงูุชุญูู ูู ุญุฌู ุงูุชุฎุฒูู ุงููุคูุช

### 3. **ุงุณุชุฑุฌุงุน ุงููููุงุช**
- ุงูุจุญุซ ุนู ุงูููู ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ
- ุงูุชุญูู ูู ุนูุฑ ุงูููู
- ุฅุฑุฌุงุน ุงูููู ุฅุฐุง ูุงู ุตุงูุญุงู
- ุญุฐู ุงูููู ุฅุฐุง ุงูุชูุช ุตูุงุญูุชู

### 4. **ุงูุชูุธูู ุงูุชููุงุฆู**
- ุญุฐู ุงููููุงุช ุงูุชู ุงูุชูุช ุตูุงุญูุชูุง
- ุญุฐู ุฃูุฏู ุงููููุงุช ุนูุฏ ุชุฌุงูุฒ ุงูุญุฏ ุงูุฃูุตู
- ุชุญุฏูุซ timestamps

## ุงูููุงุฆุฏ

### 1. **ุชุญุณูู ุงูุฃุฏุงุก**
- **ุชุญููู ุฃุณุฑุน**: ุงูุตูุฑ ุงููุฎุฒูุฉ ูุญููุงู ุชุชุญูู ุฃุณุฑุน
- **ุชูููู ุงุณุชููุงู ุงูุจูุงูุงุช**: ุนุฏู ุชุญููู ุงูุตูุฑ ุงููุชูุฑุฑุฉ
- **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู**: ุนุฑุถ ููุฑู ููุตูุฑ ุงููุฎุฒูุฉ

### 2. **ุฅุฏุงุฑุฉ ุฐููุฉ ูููุณุงุญุฉ**
- **ุชูุธูู ุชููุงุฆู**: ุญุฐู ุงููููุงุช ุงููุฏููุฉ ุชููุงุฆูุงู
- **ุถุบุท ุฐูู**: ุฅุฏุงุฑุฉ ุงููุณุงุญุฉ ุญุณุจ ุงูุฃููููุฉ
- **ูุฑุงูุจุฉ ุงูุงุณุชุฎุฏุงู**: ุนุฑุถ ูุนูููุงุช ููุตูุฉ ุนู ุงูุงุณุชุฎุฏุงู

### 3. **ููุซูููุฉ ุนุงููุฉ**
- **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**: ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
- **ุงุณุชุฑุฏุงุฏ ุขูู**: ุงุณุชุฑุฏุงุฏ ุขูู ูููููุงุช ุงูุชุงููุฉ
- **ุฃูุงู ุงูุจูุงูุงุช**: ุงุณุชุฎุฏุงู ููุงุชูุญ ูุฑูุฏุฉ ูุขููุฉ

## ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุญุณูู

### 1. **ุถุบุท ุงูุตูุฑ**
ูููู ุฅุถุงูุฉ ุถุบุท ููุตูุฑ ูุจู ุงูุชุฎุฒูู:
```dart
import 'package:flutter_image_compress/flutter_image_compress.dart';

Future<Uint8List> compressImage(Uint8List imageData) async {
  return await FlutterImageCompress.compressWithList(
    imageData,
    quality: 85,
  );
}
```

### 2. **ุชุฎุฒูู ูุชุนุฏุฏ ุงููุณุชููุงุช**
```dart
// ุชุฎุฒูู ูุณุฎ ูุฎุชููุฉ ูู ุงูุตูุฑุฉ
await cacheImage('${url}_thumb', thumbnailData);
await cacheImage('${url}_medium', mediumData);
await cacheImage('${url}_full', fullData);
```

### 3. **ุชุญููู ูุณุจู**
```dart
// ุชุญููู ูุณุจู ููุตูุฑ ุงููุชููุนุฉ
Future<void> preloadImages(List<String> imageUrls) async {
  for (final url in imageUrls) {
    if (!await isImageCached(url)) {
      // ุชุญููู ุงูุตูุฑุฉ ูู ุงูุฎูููุฉ
      _loadImageInBackground(url);
    }
  }
}
```

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### **ูุดุงูู ุดุงุฆุนุฉ ูุญููููุง**

#### 1. **ุฎุทุฃ ูู ุงููุตูู ูููุฌูุฏ**
```dart
// ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงููุฌูุฏ
if (!await _cacheDir!.exists()) {
  await _cacheDir!.create(recursive: true);
}
```

#### 2. **ุฎุทุฃ ูู ุญูุธ ุงูููู**
```dart
try {
  await file.writeAsBytes(imageData);
} catch (e) {
  debugPrint('Error saving file: $e');
  // ุญุฐู ุงูููู ุงูุชุงูู
  if (await file.exists()) {
    await file.delete();
  }
}
```

#### 3. **ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูููู**
```dart
if (await file.exists()) {
  try {
    final size = await file.length();
    if (size > 0) {
      return file;
    }
  } catch (e) {
    // ุญุฐู ุงูููู ุงูุชุงูู
    await file.delete();
  }
}
```

## ุงููุฑุงูุจุฉ ูุงูุชูุงุฑูุฑ

### **ุฅุญุตุงุฆูุงุช ุงูุงุณุชุฎุฏุงู**
```dart
final cacheInfo = await ImageCacheService().getCacheInfo();
print('''
ูุนูููุงุช ุงูุชุฎุฒูู ุงููุคูุช:
- ุงูุญุฌู ุงููุณุชุฎุฏู: ${cacheInfo.totalSizeMB} MB
- ุนุฏุฏ ุงููููุงุช: ${cacheInfo.fileCount}
- ุงููููุงุช ุงูุตุงูุญุฉ: ${cacheInfo.validFiles}
- ูุณุจุฉ ุงูุงุณุชุฎุฏุงู: ${cacheInfo.usagePercentage}%
- ุงูุนูุฑ ุงูุฃูุตู: ${cacheInfo.maxAgeDays} ููู
''');
```

### **ุชูุจููุงุช ุงููุธุงู**
```dart
if (cacheInfo.usagePercentage > 80) {
  // ุชูุจูู: ุงูุชุฎุฒูู ุงููุคูุช ููุชูุฆ ุชูุฑูุจุงู
  _showCacheWarning();
}
```

## ุงูุชุทููุฑ ุงููุณุชูุจูู

### 1. **ููุฒุงุช ุฅุถุงููุฉ**
- **ุชุฎุฒูู ุณุญุงุจู**: ุฑูุน ุงูุตูุฑ ุฅูู ุงูุชุฎุฒูู ุงูุณุญุงุจู
- **ูุฒุงููุฉ ูุชุนุฏุฏุฉ ุงูุฃุฌูุฒุฉ**: ูุฒุงููุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจูู ุงูุฃุฌูุฒุฉ
- **ุชุญููู ุงูุงุณุชุฎุฏุงู**: ุฅุญุตุงุฆูุงุช ููุตูุฉ ุนู ุงุณุชุฎุฏุงู ุงูุตูุฑ

### 2. **ุชุญุณููุงุช ุงูุฃุฏุงุก**
- **ุถุบุท ูุชูุฏู**: ุถุบุท ุฐูู ููุตูุฑ ุญุณุจ ุงูุญุฌู
- **ุชุญููู ุชุฏุฑูุฌู**: ุชุญููู ุชุฏุฑูุฌู ููุตูุฑ ุงููุจูุฑุฉ
- **ุฐุงูุฑุฉ ูุคูุชุฉ**: ุชุฎุฒูู ูุคูุช ูู ุงูุฐุงูุฑุฉ ููุตูุฑ ุงููุณุชุฎุฏูุฉ ุจูุซุฑุฉ

### 3. **ููุฒุงุช ุฅุฏุงุฑูุฉ**
- **ุฅุนุฏุงุฏุงุช ูุชูุฏูุฉ**: ุชุฎุตูุต ุฅุนุฏุงุฏุงุช ุงูุชุฎุฒูู ุงููุคูุช
- **ุชูุงุฑูุฑ ููุตูุฉ**: ุชูุงุฑูุฑ ููุตูุฉ ุนู ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู
- **ุชูุจููุงุช ุฐููุฉ**: ุชูุจููุงุช ุนูุฏ ุงูุญุงุฌุฉ ูุชูุธูู ุงูุชุฎุฒูู

## ุงูุฎูุงุตุฉ

ูุธุงู ุงูุชุฎุฒูู ุงููุคูุช ููุตูุฑ ูู FoudaMarket ูููุฑ:
- **ุฃุฏุงุก ูุญุณู** ูุน ุชุญููู ุฃุณุฑุน ููุตูุฑ
- **ุฅุฏุงุฑุฉ ุฐููุฉ** ูููุณุงุญุฉ ูุน ุชูุธูู ุชููุงุฆู
- **ูุงุฌูุฉ ุฅุฏุงุฑูุฉ** ุดุงููุฉ ููุฑุงูุจุฉ ุงูุงุณุชุฎุฏุงู
- **ููุซูููุฉ ุนุงููุฉ** ูุน ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
- **ูุงุจููุฉ ุงูุชูุณุน** ูุน ุฅููุงููุฉ ุงูุชุฎุตูุต ูุงูุชุทููุฑ

ูุฐุง ุงููุธุงู ูุณุงูู ุจุดูู ูุจูุฑ ูู ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ูุชูููู ุงุณุชููุงู ุงูุจูุงูุงุช ูู ุงูุชุทุจูู. ๐ 