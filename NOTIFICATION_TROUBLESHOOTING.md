# ุฏููู ุงุณุชูุดุงู ุฃุฎุทุงุก ุงูุฅุดุนุงุฑุงุช ูู FoudaMarket

## ุงููุดููุฉ
ุงูุฅุดุนุงุฑุงุช ูุง ุชุตู ูููุงุชู ุงูุขุฎุฑ ุฑุบู ุฃู ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ููููุญุฉ.

## ุฎุทูุงุช ุงูุชุดุฎูุต ูุงูุญู

### 1. ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจู Vercel API

#### ุฃ. ูู ุดุงุดุฉ ุงูุทูุจุงุช:
1. ุงุฐูุจ ุฅูู ุดุงุดุฉ ุงูุทูุจุงุช ูู ุงูุฅุฏุงุฑุฉ
2. ุงุถุบุท ุนูู ุฒุฑ "ุงุฎุชุจุงุฑ ุงูุงุชุตุงู"
3. ุฑุงูุจ ุงูุฑุณุงูุฉ:
   - โ "ุงูุงุชุตุงู ุจู Vercel API ูุนูู ุจุดูู ุตุญูุญ" = ุงููุดููุฉ ููุณุช ูู ุงูุฎุงุฏู
   - โ "ูุดููุฉ ูู ุงูุงุชุตุงู ุจู Vercel API" = ุงููุดููุฉ ูู ุงูุฎุงุฏู

#### ุจ. ูุญุต FCM Token:
1. ุงุถุบุท ุนูู ุฒุฑ "ูุญุต FCM Token"
2. ุฑุงูุจ ุงูุฑุณุงูุฉ:
   - โ "FCM Token ููุฌูุฏ: [token]..." = ุงูุชููู ููุฌูุฏ
   - โ "FCM Token ุบูุฑ ููุฌูุฏ" = ุงููุดููุฉ ูู ุงูุชููู

### 2. ุชุดุฎูุต ุงููุดุงูู ุงููุญุชููุฉ

#### ุงููุดููุฉ ุงูุฃููู: FCM Token ุบูุฑ ุตุงูุญ
**ุงูุฃุนุฑุงุถ:**
- ุฑุณุงูุฉ 404 ูู Vercel API
- "FCM Token ุบูุฑ ุตุงูุญ" ูู ุงูุณุฌูุงุช

**ุงูุญู:**
```bash
# ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู
flutter clean
flutter pub get
flutter run
```

#### ุงููุดููุฉ ุงูุซุงููุฉ: ูุดููุฉ ูู Vercel API
**ุงูุฃุนุฑุงุถ:**
- ุฑุณุงูุฉ 401 (ุฎุทุฃ ูู ุงููุตุงุฏูุฉ)
- ุฑุณุงูุฉ 500 (ุฎุทุฃ ูู ุงูุฎุงุฏู)

**ุงูุญู:**
1. ุชุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ูู Vercel:
   ```bash
   vercel env ls
   ```

2. ุชุฃูุฏ ูู ูุฌูุฏ `FCM_SERVICE_ACCOUNT_JSON`:
   ```bash
   vercel env pull .env.local
   ```

3. ุฅุนุงุฏุฉ ูุดุฑ Vercel API:
   ```bash
   cd fcm-api
   vercel --prod
   ```

#### ุงููุดููุฉ ุงูุซุงูุซุฉ: ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ ูู ุงูุชุทุจูู
**ุงูุฃุนุฑุงุถ:**
- ุงูุฅุดุนุงุฑุงุช ุชุตู ููุฎุงุฏู (200 OK)
- ูุง ุชุธูุฑ ูู ุงูุชุทุจูู

**ุงูุญู:**
1. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช ูู ุงูุชุทุจูู:
   - ุงุฐูุจ ุฅูู ุดุงุดุฉ ุงูููู ุงูุดุฎุตู
   - ุงุถุบุท ุนูู "ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช"

2. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฌูุงุฒ:
   - ุฅุนุฏุงุฏุงุช ุงูุฌูุงุฒ > ุงูุชุทุจููุงุช > FoudaMarket > ุตูุงุญูุงุช > ุงูุฅุดุนุงุฑุงุช

### 3. ุงุฎุชุจุงุฑ ุดุงูู ููุฅุดุนุงุฑุงุช

#### ุฃ. ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู:
1. ุงุฐูุจ ุฅูู ุดุงุดุฉ ุงูุทูุจุงุช
2. ุงุฎุชุฑ ุฃู ุทูุจ
3. ุงุถุบุท ุนูู "ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑ"
4. ุฑุงูุจ ุงูุณุฌูุงุช ููุจุญุซ ุนู:
   ```
   [FCM] ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู ุนุจุฑ Vercel API
   [FCM] ุงุณุชุฌุงุจุฉ ุงูุฎุงุฏู: 200 - {"success":true,"messageId":"..."}
   [FCM] โ ุชู ุฅุฑุณุงู ุงูุฅุดุนุงุฑ ุจูุฌุงุญ ุนุจุฑ Vercel API
   ```

#### ุจ. ุงุฎุชุจุงุฑ ุงุณุชูุจุงู ุงูุฅุดุนุงุฑุงุช:
1. ุงูุชุญ ุงูุชุทุจูู ุนูู ุงููุงุชู ุงููุณุชูุฏู
2. ุชุฃูุฏ ูู ุฃู ุงูุชุทุจูู ููุชูุญ ูู ุงูููุฏูุฉ
3. ุฃุฑุณู ุฅุดุนุงุฑ ุชุฌุฑูุจู ูู ุงููุงุชู ุงูุขุฎุฑ
4. ุฑุงูุจ ุงูุณุฌูุงุช ููุจุญุซ ุนู:
   ```
   ๐ [FCM] Received a foreground message: [messageId]
   ๐ [FCM] Notification: Title=[title], Body=[body]
   ```

### 4. ุญููู ุฅุถุงููุฉ

#### ุฃ. ุฅุนุงุฏุฉ ุชุนููู FCM Token:
```dart
// ูู ุงูุชุทุจูู
await FirebaseMessaging.instance.deleteToken();
String? newToken = await FirebaseMessaging.instance.getToken();
```

#### ุจ. ุงุฎุชุจุงุฑ ุนูู ุฌูุงุฒ ุญูููู:
- ุจุนุถ ุงููุญุงููุงุช ูุง ุชุฏุนู ุงูุฅุดุนุงุฑุงุช ุจุดูู ุตุญูุญ
- ุฌุฑุจ ุนูู ูุงุชู ุญูููู

#### ุฌ. ุชุญูู ูู ุฅุนุฏุงุฏุงุช Firebase:
1. ุงุฐูุจ ุฅูู Firebase Console
2. ุชุฃูุฏ ูู ุชูุนูู Firebase Cloud Messaging
3. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู

### 5. ุฃูุงูุฑ ุงูุชุดุฎูุต

#### ุฃ. ูุญุต ุณุฌูุงุช ุงูุชุทุจูู:
```bash
flutter logs
```

#### ุจ. ูุญุต ุณุฌูุงุช Vercel:
```bash
vercel logs
```

#### ุฌ. ุงุฎุชุจุงุฑ Vercel API ูุจุงุดุฑุฉ:
```bash
curl -X POST https://fcm-api-seven.vercel.app/api/send-fcm \
  -H "Content-Type: application/json" \
  -d '{
    "fcmToken": "YOUR_FCM_TOKEN",
    "title": "ุงุฎุชุจุงุฑ",
    "body": "ูุฐุง ุงุฎุชุจุงุฑ",
    "data": {"test": "true"}
  }'
```

### 6. ุฑุณุงุฆู ุงูุฎุทุฃ ุงูุดุงุฆุนุฉ ูุญููููุง

#### ุฑุณุงูุฉ 404 - FCM Token ุบูุฑ ุตุงูุญ:
```
[FCM] โ FCM Token ุบูุฑ ุตุงูุญ (404)
[FCM] ๐ก ุงูุณุจุจ: FCM Token ูุฏูู ุฃู ุบูุฑ ุตุงูุญ
```
**ุงูุญู:** ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู ุฃู ุชุญุฏูุซ ุงูุชููู

#### ุฑุณุงูุฉ 401 - ุฎุทุฃ ูู ุงููุตุงุฏูุฉ:
```
[FCM] โ ุฎุทุฃ ูู ุงููุตุงุฏูุฉ (401)
[FCM] ๐ก ุงูุณุจุจ: ูุดููุฉ ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ูู Vercel
```
**ุงูุญู:** ุชุญุฏูุซ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ูู Vercel

#### ุฑุณุงูุฉ Timeout:
```
[FCM] โ ูุดู ูู ุฅุฑุณุงู ุงูุฅุดุนุงุฑ: TimeoutException
[FCM] ๐ก ุงูุณุจุจ: ุงูุชูุช ูููุฉ ุงูุงุชุตุงู ุจุงูุฎุงุฏู
```
**ุงูุญู:** ุชุญูู ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช ุฃู ุฅุนุงุฏุฉ ุงููุญุงููุฉ

### 7. ุฎุทูุงุช ุงูุชุญูู ุงูููุงุฆูุฉ

1. **ุชุญูู ูู ุงูุงุชุตุงู:**
   - ุงุถุบุท "ุงุฎุชุจุงุฑ ุงูุงุชุตุงู" ูู ุดุงุดุฉ ุงูุทูุจุงุช

2. **ุชุญูู ูู FCM Token:**
   - ุงุถุบุท "ูุญุต FCM Token" ูู ุดุงุดุฉ ุงูุทูุจุงุช

3. **ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุงูุฅุดุนุงุฑ:**
   - ุงุถุบุท "ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑ" ุนูู ุฃู ุทูุจ

4. **ุชุญูู ูู ุงุณุชูุจุงู ุงูุฅุดุนุงุฑ:**
   - ุฑุงูุจ ุงูุณุฌูุงุช ููุจุญุซ ุนู ุฑุณุงุฆู ุงูุงุณุชูุจุงู

5. **ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฌูุงุฒ:**
   - ุชุฃูุฏ ูู ุชูุนูู ุงูุฅุดุนุงุฑุงุช ูู ุฅุนุฏุงุฏุงุช ุงูุฌูุงุฒ

### 8. ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ูุฐู ุงูุฎุทูุงุช:
- โ ุงูุงุชุตุงู ุจู Vercel API ูุนูู
- โ FCM Token ุตุงูุญ ููุญุฏุซ
- โ ุงูุฅุดุนุงุฑุงุช ุชุตู ููุฎุงุฏู ุจูุฌุงุญ
- โ ุงูุฅุดุนุงุฑุงุช ุชุธูุฑ ูู ุงูุชุทุจูู
- โ ุงูุฅุดุนุงุฑุงุช ุชุตู ูููุงุชู ุงูุขุฎุฑ

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ูุฑุฌู ูุดุงุฑูุฉ:
1. ุฑุณุงุฆู ุงูุณุฌูุงุช ุงููุงููุฉ
2. ูุชูุฌุฉ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
3. ูุชูุฌุฉ ูุญุต FCM Token
4. ููุน ุงูุฌูุงุฒ ููุธุงู ุงูุชุดุบูู 