# ุฏููู ุชุทุจูู reCAPTCHA SMS Defense

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุชุทุจูู ูุธุงู reCAPTCHA SMS Defense ูุญูุงูุฉ ุชุทุจูู Fouda Market ูู ูุฌูุงุช SMS fraud ูSMS pumping. ูุฐุง ุงููุธุงู ูููุฑ:

- **ุชุญููู ุงููุฎุงุทุฑ ูุจู ุฅุฑุณุงู SMS** - ุชูููู ูู ุฑูู ูุงุชู ูุจู ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู
- **ุญุธุฑ ุงูุฃุฑูุงู ุนุงููุฉ ุงููุฎุงุทุฑ** - ููุน ุฅุฑุณุงู SMS ููุฃุฑูุงู ุงููุดุจููุฉ
- **ุชุชุจุน ูุชุญููู ุงูุฃูุดุทุฉ** - ูุฑุงูุจุฉ ูุญุงููุงุช ุงููุตุงุฏูุฉ ูุชุญููููุง
- **ุญูุงูุฉ ูู ุงูุงุญุชูุงู** - ููุน SMS toll fraud ูSMS pumping attacks

## ุงููููุงุช ุงููุถุงูุฉ

### 1. ุฎุฏูุฉ reCAPTCHA SMS Defense
**ุงููุณุงุฑ:** `lib/services/recaptcha_sms_defense.dart`

**ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ:**
```dart
// ุฅูุดุงุก ุชูููู ูููุฎุงุทุฑ
Future<SmsRiskAssessment> createAssessment({
  required String phoneNumber,
  required String accountId,
  String? token,
})

// ุชุณุฌูู ูุชุงุฆุฌ ุงูุนูููุงุช
Future<void> annotateAssessment({
  required String assessmentId,
  required String phoneNumber,
  required SmsEventType eventType,
  SmsAnnotation? annotation,
})

// ุชุญุฏูุฏ ูุณุชูู ุงููุฎุงุทุฑ
bool shouldBlockSms(double riskScore)
```

### 2. ููู ุงูุชูููู
**ุงููุณุงุฑ:** `lib/config/recaptcha_config.dart`

**ุงููุนุงููุฑ ุงููููุฉ:**
- `highRiskThreshold = 0.7` (70%) - ุญุธุฑ ููุฑู
- `mediumRiskThreshold = 0.4` (40%) - ูุฑุงูุจุฉ ุฅุถุงููุฉ
- `lowRiskThreshold = 0.2` (20%) - ุงูุณูุงุญ ุจุงููุฑูุฑ

### 3. ุชุญุฏูุซ AuthService
**ุงููุณุงุฑ:** `lib/core/services/auth_service.dart`

**ุงูููุฒุงุช ุงููุถุงูุฉ:**
- ุฏูุฌ reCAPTCHA ูุน ุนูููุฉ ุงูุชุญูู ูู ุงููุงุชู
- ุชุญููู ุฃุฑูุงู ุงููุงุชู ูุตูุบุฉ E.164 ุชููุงุฆูุงู
- ุชุณุฌูู ุฌููุน ุฃุญุฏุงุซ SMS (ุฅุฑุณุงูุ ูุฌุงุญุ ูุดู)

### 4. ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู
**ุงููุณุงุฑ:** `lib/views/auth/phone_login_screen.dart`

**ุงูุชุญุณููุงุช:**
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููุฃุฑูุงู ุนุงููุฉ ุงููุฎุงุทุฑ
- ุญูุงุฑุงุช ุชูุงุนููุฉ ูุน ุญููู ููุชุฑุญุฉ
- ูุนุงูุฌุฉ ุดุงููุฉ ูุฌููุน ุฃููุงุน ุงูุฃุฎุทุงุก

## ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### 1. ุฅุนุฏุงุฏ Google Cloud Project
```bash
# 1. ุงุฐูุจ ุฅูู Google Cloud Console
# https://console.cloud.google.com/

# 2. ูุนู reCAPTCHA Enterprise API
# APIs & Services > Library > reCAPTCHA Enterprise API > Enable

# 3. ุฅูุดุงุก Service Account
# IAM & Admin > Service Accounts > Create Service Account
# Role: reCAPTCHA Enterprise Agent
```

### 2. ุฅุนุฏุงุฏ Firebase Console
```bash
# 1. ุงุฐูุจ ุฅูู Firebase Console
# https://console.firebase.google.com/

# 2. Authentication > Settings > Phone numbers for testing
# ุฃุถู ุฃุฑูุงู ุงูุงุฎุชุจุงุฑ:
+201234567890 โ 123456
+201234567891 โ 654321

# 3. Authentication > Settings > reCAPTCHA Enterprise
# ูุนู reCAPTCHA Enterprise ูุฃุถู site key
```

### 3. ุชุญุฏูุซ ููู ุงูุชูููู
```dart
// lib/config/recaptcha_config.dart
class RecaptchaConfig {
  static const String projectId = 'your-actual-project-id';
  static const String apiKey = 'your-actual-api-key';
  static const String siteKey = 'your-actual-site-key';
}
```

### 4. ุชุดุบูู ุงูุชุทุจูู
```bash
# 1. ุชุญุฏูุซ ุงูุชุจุนูุงุช
flutter pub get

# 2. ุชุดุบูู ุงูุชุทุจูู
flutter run
```

## ููููุฉ ุนูู ุงููุธุงู

### 1. ุชุฏูู ุงูุนูู ุงูุฃุณุงุณู
```
ุงููุณุชุฎุฏู ูุฏุฎู ุฑูู ุงููุงุชู
       โ
ุชุญููู ุงูุฑูู ูุตูุบุฉ E.164
       โ
ุฅุฑุณุงู ุทูุจ ุชูููู ูู reCAPTCHA
       โ
ุชุญููู ุฏุฑุฌุฉ ุงููุฎุงุทุฑ
       โ
ุฅูุง ุงูุณูุงุญ ุฃู ุงูุญุธุฑ
       โ
ุชุณุฌูู ุงููุชูุฌุฉ ูู reCAPTCHA
```

### 2. ูุณุชููุงุช ุงููุฎุงุทุฑ
| ุงูุฏุฑุฌุฉ | ุงููุณุชูู | ุงูุฅุฌุฑุงุก |
|--------|---------|---------|
| 0.0-0.2 | ููุฎูุถ | ุงูุณูุงุญ ููุฑุงู |
| 0.2-0.4 | ูุชูุณุท | ุงูุณูุงุญ ูุน ุงููุฑุงูุจุฉ |
| 0.4-0.7 | ุนุงูู | ุชุญูู ุฅุถุงูู |
| 0.7-1.0 | ุฎุทูุฑ | ุญุธุฑ ููุฑู |

### 3. ุฃููุงุน ุงูุชุณุฌูู
- `INITIATED_TWO_FACTOR` - ุชู ุฅุฑุณุงู SMS
- `PASSED_TWO_FACTOR` - ุชู ุงูุชุญูู ุจูุฌุงุญ
- `FAILED_TWO_FACTOR` - ูุดู ุงูุชุญูู

## ุงูุฑุณุงุฆู ูุงูุฃุฎุทุงุก

### ุฑุณุงุฆู ุงููุฌุงุญ
- โ "ุชู ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู"
- โ "ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ"
- โ "ุชู ุฅุฑุณุงู ุฑูุฒ ุฌุฏูุฏ"

### ุฑุณุงุฆู ุงูุฃุฎุทุงุก
- ๐ซ "ุชู ุฑูุถ ูุฐุง ุงูุฑูู ูุฃุณุจุงุจ ุฃูููุฉ"
- โ๏ธ "ุชู ุญุธุฑ ุงูุฌูุงุฒ ูุคูุชุงู ุจุณุจุจ ูุซุฑุฉ ุงูุทูุจุงุช"
- ๐ "ุฑูู ุงููุงุชู ูุฌุจ ุฃู ูุจุฏุฃ ุจู 01 ููููู 11 ุฑูู"

## ุงููุฑุงูุจุฉ ูุงูุชุญููู

### 1. ุณุฌูุงุช ุงููุธุงู
```dart
print('๐ก๏ธ Checking SMS risk for: $phoneNumber');
print('๐ Risk assessment: score=$riskScore');
print('โ Low risk - proceeding normally');
print('๐จ Very high risk detected - blocking immediately');
```

### 2. ุฅุญุตุงุฆูุงุช ูููุฏุฉ
- ุนุฏุฏ ุงูุทูุจุงุช ุงููุญุธูุฑุฉ ููููุงู
- ูุนุฏู ูุฌุงุญ ุงูุชุญูู
- ุงูุฃุฑูุงู ุนุงููุฉ ุงููุฎุงุทุฑ
- ุชูุฒูุน ุฏุฑุฌุงุช ุงููุฎุงุทุฑ

## ุฃูุถู ุงูููุงุฑุณุงุช

### 1. ููุชุทููุฑ
- ุงุณุชุฎุฏู ุฃุฑูุงู ุงูุงุฎุชุจุงุฑ ูู Firebase Console
- ูุนู ูุถุน ุงูุชุตุญูุญ ูู RecaptchaConfig
- ุฑุงูุจ ุงูุณุฌูุงุช ุจุงุณุชูุฑุงุฑ

### 2. ููุฅูุชุงุฌ
- ุงุณุชุฎุฏู ููุงุชูุญ ูููุตูุฉ ููุฅูุชุงุฌ
- ุฑุงูุจ ูุนุฏูุงุช ุงูุญุธุฑ
- ุงุถุจุท ุนุชุจุงุช ุงููุฎุงุทุฑ ุญุณุจ ุงูุจูุงูุงุช

### 3. ุงูุฃูุงู
- ูุง ุชุฎุฒู ุงูููุงุชูุญ ูู ุงูููุฏ
- ุงุณุชุฎุฏู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- ุฑุงุฌุน ุงูุตูุงุญูุงุช ุจุงูุชุธุงู

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ ูุญููููุง

| ุงููุดููุฉ | ุงูุณุจุจ | ุงูุญู |
|---------|-------|------|
| "Assessment failed: 401" | ููุชุงุญ API ุฎุงุทุฆ | ุชุญูู ูู API key |
| "Project not found" | ูุนุฑู ุงููุดุฑูุน ุฎุงุทุฆ | ุชุญูู ูู project ID |
| "reCAPTCHA not initialized" | ุชูููู ุฎุงุทุฆ | ุฑุงุฌุน RecaptchaConfig |
| "High risk detected" | ุฑูู ูุดุจูู | ุงุณุชุฎุฏู ุฑูู ุขุฎุฑ |

### ุฃูุงูุฑ ุงูุชุดุฎูุต
```bash
# ูุญุต ุงูุชุจุนูุงุช
flutter pub deps

# ูุญุต ุงูุฃุฎุทุงุก
flutter analyze

# ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช
flutter test
```

## ุงูุชูุงููู ุงููุชููุนุฉ

### Google Cloud reCAPTCHA Enterprise
- **ุฃูู 1000 ุชูููู ุดูุฑูุงู:** ูุฌุงูู
- **ุจุนุฏ ุฐูู:** $1 ููู 1000 ุชูููู
- **ุงูุชุณุฌูู:** ูุฌุงูู

### Firebase Authentication
- **SMS:** ุชูููุฉ ุญุณุจ ุงููุฒูุฏ
- **ุงูุชุญูู:** ูุฌุงูู

## ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู ูุธุงู reCAPTCHA SMS Defense ุจูุฌุงุญ ูู ุชุทุจูู Fouda Market ูุน:

โ **ุญูุงูุฉ ุดุงููุฉ** ูู SMS fraud  
โ **ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ** ูุน ุฑุณุงุฆู ูุงุถุญุฉ  
โ **ูุธุงู ุชุณุฌูู ูุชูุฏู** ูุชุญููู ุงูุฃูุดุทุฉ  
โ **ุฅุนุฏุงุฏุงุช ูุฑูุฉ** ููุจูุฆุงุช ุงููุฎุชููุฉ  
โ **ููุงููุฉ ุงูุฃุฎุทุงุก** ูุน ูุธุงู fallback  

ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ููููุฑ ุญูุงูุฉ ูููุฉ ุถุฏ ูุญุงููุงุช ุงูุงุญุชูุงู ุนุจุฑ SMS!
